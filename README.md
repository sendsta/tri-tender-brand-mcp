# Tri-Tender Brand & Letterhead MCP

This MCP is the **Brand & Letterhead Engine** for the Tri-Tender ecosystem.

It:

- Reads company documents & assets (PDF letterheads, DOCX profiles, images, brand guides).
- Detects:
  - Logos from PDFs via **PyMuPDF**.
  - Dominant colors from logos/images via **Pillow**.
  - Text & fonts from PDFs via **pdfplumber**.
  - Hex colors inside text (brand guides / CSS snippets inside docs).
- Builds a `BrandProfile` (colors, fonts, logo URL, chart palette).
- Generates:
  - HTML letterhead templates with CSS tokens.
  - Rendered full HTML that wraps any body HTML into your letterhead.
  - Graph style guide (series colors, fonts, etc.).
  - SVG (and PNG) bar charts.
  - **Brand Book** (HTML + PDF base64) summarising all brand elements inferred.

Ideal for running on **FastMCP Cloud** and connecting to **Tri-Tender Desktop / Dyad**.

---

## 1. Project Structure

```text
tri_tender_brand_letterhead_mcp/
├─ server.py
├─ requirements.txt
├─ fastmcp.toml
└─ brand_engine/
   ├─ __init__.py
   ├─ brand_profile.py
   ├─ extractors.py
   ├─ templates.py
   ├─ charts.py
   ├─ brand_book.py
   └─ utils.py
```

---

## 2. Tools Exposed

All tools are registered on the MCP server via `fastmcp`:

1. `build_brand_profile(file_paths: string[]) -> BrandProfile`
2. `get_letterhead_template(brand_profile: BrandProfile) -> string`
3. `render_letter_with_body(brand_profile: BrandProfile, body_html: string, title?: string) -> string`
4. `get_graph_style(brand_profile: BrandProfile) -> GraphStyleGuide`
5. `build_bar_chart_svg(brand_profile, series, title?, width?, height?) -> string`
6. `build_bar_chart_png(brand_profile, series, title?, width?, height?) -> string`
7. `generate_brand_book(brand_profile) -> { html: string, pdf_data_url: string }`

### Brand Book Tool

`generate_brand_book` produces:

- `html`: a multi-section HTML Brand Book you can store and preview (e.g. `brand-book.html`).
- `pdf_data_url`: a base64-encoded PDF as a `data:application/pdf;base64,...` string, generated with `reportlab`.

The Brand Book includes:

- Cover page (company name, logo, brand summary).
- Color palette with visual swatches.
- Typography section (heading / body fonts).
- Logo usage block.
- Chart & data visualisation palette.
- “Usage in Tri-Tender” section explaining how the brand is applied to tender documents.

---

## 3. FastMCP Cloud Deployment

### Step 1: Create a New Project

1. Push this folder to GitHub (e.g. `tri-tender-brand-letterhead-mcp` repo).
2. Go to **fastmcp.cloud**.
3. Create a new project from your GitHub repo.
4. Set:

   - **Entrypoint:** `server.py:mcp`
   - **Language:** Python 3.12 (or higher if supported).

FastMCP Cloud will automatically:

- Clone the repository.
- Install `requirements.txt` (including `reportlab` for PDF generation).
- Bootstrap the MCP server.

### Step 2: Verify Build

Once deployed, FastMCP Cloud will display the MCP endpoint, e.g.:

```text
https://tri-tender-brand-letterhead-mcp.fastmcp.app/mcp
```

Copy this URL for your Tri-Tender desktop app / Dyad configuration.

---

## 4. Connecting from an MCP Client

Example configuration snippet (for Claude Desktop / Dyad-style client):

```jsonc
{
  "mcpServers": {
    "tri-tender-brand-letterhead": {
      "url": "https://tri-tender-brand-letterhead-mcp.fastmcp.app/mcp"
    }
  }
}
```

---

## 5. Brand Book Usage Flow Inside Tri-Tender

### 5.1 After Brand Profile

1. User uploads company documents (letterhead, profile, brand guide, logos).
2. Orchestrator calls:

```jsonc
{
  "tool": "tri-tender-brand-letterhead-mcp/build_brand_profile",
  "arguments": {
    "file_paths": [ "...paths..." ]
  }
}
```

3. Store the resulting `BrandProfile` in your project.

### 5.2 Generate Brand Book

Call:

```jsonc
{
  "tool": "tri-tender-brand-letterhead-mcp/generate_brand_book",
  "arguments": {
    "brand_profile": { /* BrandProfile JSON */ }
  }
}
```

You get:

- `html` – save as `brand-book.html` in the project.
- `pdf_data_url` – decode and save as `brand-book.pdf` or pass to your Tender Compiler MCP.

This gives clients a **single reference document** for how Tri-Tender sees and uses their brand.

---

## 6. Local Development (Optional)

```bash
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate
pip install -r requirements.txt
python server.py
```

The MCP will start listening on STDIO for MCP messages (used by compatible clients).

---

## 7. Extending the Brand Book

You can extend `brand_engine/brand_book.py` to:

- Add sample pages of letterheads and charts.
- Insert sample tender cover pages as if generated by Tri-Tender.
- Include brand tone-of-voice guidelines, generated from separate NLP analysis.

This version is production-ready for **FastMCP Cloud** and tightly aligned with the Tri-Tender workflow.
